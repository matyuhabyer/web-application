<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Head Section -->
    <meta charset="utf-8">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <title>Search | Tafteria</title>
</head>
<body class="font-sans bg-gray-100">
    <!-- Header Section -->
    <header class="w-full bg-green-800 h-20 flex items-center justify-between px-5 text-white relative z-10">
        <div class="flex items-center">
            <!-- Sidebar Toggle Button -->
            <div class="w-7 h-6 bg-no-repeat bg-center cursor-pointer" onclick="toggleSidebar()" style="background-image: url(nav-icon.png);"></div>
            <!-- Logo -->
            <a href="index.html">
                <img class="w-64 h-auto ml-5" alt="Tafteria Logo" src="tafteria-logo.png">
            </a>
        </div>
        <!-- Search Bar -->
        <div class="flex-grow max-w-md mx-5">
            <form action="search.html" method="GET" class="flex">
                <input type="text" name="query" class="w-full h-10 rounded-l-lg border border-gray-300 px-4 text-black" placeholder="Search establishments or reviews...">
                <button type="submit" class="h-10 px-4 rounded-r-lg bg-yellow-500 text-white hover:bg-yellow-400 transition-colors">Search</button>
            </form>
        </div>
        <!-- Register and Login Buttons -->
        <div class="flex items-center">
            <a class="bg-yellow-500 w-32 h-9 flex items-center justify-center rounded-lg font-bold text-white hover:bg-white hover:text-yellow-500 transition-colors mx-2" href="register.html">Register</a>
            <a class="bg-yellow-500 w-32 h-9 flex items-center justify-center rounded-lg font-bold text-white hover:bg-white hover:text-yellow-500 transition-colors mx-2" href="login.html">Login</a>
        </div>
    </header>

    <!-- Sidebar Navigation -->
    <nav id="sidebar" class="h-full fixed top-0 left-0 bg-green-900 w-0 overflow-x-hidden transition-width duration-500 pt-16 z-20">
        <!-- Close Button -->
        <a href="javascript:void(0)" class="absolute top-0 right-10 text-white text-3xl hover:text-yellow-500" onclick="toggleSidebar()">&times;</a>
        <!-- Navigation Links -->
        <a href="index.html" class="block py-3 px-6 text-white text-xl hover:text-yellow-500">Home</a>
        <a href="profile.html" class="block py-3 px-6 text-white text-xl hover:text-yellow-500">Profile</a>
        <a href="establishments.html" class="block py-3 px-6 text-white text-xl hover:text-yellow-500">Establishments</a>
    </nav>

        <!-- Main Section -->
    <div class="flex items-center justify-center h-full bg-cover bg-center" style="background-image: url(agno1.jpg);">
        <div class="w-screen h-full flex flex-col items-center justify-center bg-black bg-opacity-50 text-white p-10">
            <div class="flex flex-col items-center justify-center py-10">
                <h1 class="text-5xl font-bold mb-5">Search Results</h1>
                <p class="text-2xl mb-10 font-bold">Results for "<span id="search-query" class="font-semibold"></span>"</p>

                <!-- Filters -->
                <div class="w-full flex justify-end mb-5">
                    <select id="rating-filter" class="h-10 px-4 rounded-lg border border-gray-300 text-black">
                        <option value="all">All Ratings</option>
                        <option value="4.5">4.5 & Up</option>
                        <option value="4.0">4.0 & Up</option>
                        <option value="3.5">3.5 & Up</option>
                    </select>
                </div>

                <div class="w-full grid grid-cols-1 md:grid-cols-2 gap-10 px-5">
                   <!-- Establishment Results -->
                    <div id="establishment-results" class="col-span-1 md:col-span-2">
                        <h2 class="text-3xl font-bold mb-5">Establishments</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-10 text-black">
                            <!-- Placeholder for establishment results -->
                            <div id="establishment-results-container"></div>
                        </div>
                    </div>

                    <!-- Review Results -->
                    <div id="review-results" class="col-span-1 md:col-span-2">
                        <h2 class="text-3xl font-bold mb-5">Reviews</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-10 text-black">
                            <!-- Placeholder for review results -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Section -->
    <footer class="w-full h-20 bg-green-800 text-white py-5 flex justify-between items-center px-5">
        <div>Â© Tafteria 2024 (CCAPDEV Group 14)</div>
        <a class="bg-yellow-500 w-32 h-9 flex items-center justify-center rounded-lg font-bold text-white hover:bg-white hover:text-yellow-500 transition-colors" href="#">To the top</a>
    </footer>

    <script>
        function toggleSidebar() {
            var sidebar = document.getElementById("sidebar");
            if (sidebar.style.width === "0px" || sidebar.style.width === "") {
                sidebar.style.width = "250px";
            } else {
                sidebar.style.width = "0";
            }
        }

        const establishments = [
            { name: "24 Chicken", description: "Korean fried chicken", rating: 4.5, reviews: 100, image: "24chicken.jpg", link: "24chicken-page.html" },
            { name: "Ate Rica's Bacsilog", description: "Filipino comfort food", rating: 4.3, reviews: 80, image: "bacsilog.jpg", link: "bacsilog-page.html" },
            { name: "Mongolian Master", description: "Mongolian barbecue", rating: 4.3, reviews: 80, image: "mongolian.jpg", link: "mongolian-page.html" },
            { name: "Prelude Cafe", description: "Cozy coffee shop", rating: 4.3, reviews: 80, image: "prelude.jpg", link: "prelude-page.html" },
            { name: "Subway", description: "Fresh sandwiches", rating: 4.3, reviews: 80, image: "subway.jpeg", link: "subway-page.html" }
        ];
    
        const reviews = [
            { title: "Great Chicken!", body: "Loved the Korean fried chicken at 24 Chicken.", establishment: "24 Chicken", profile: "John Doe" },
            { title: "Best Bacsilog", body: "Ate Rica's Bacsilog is my favorite comfort food.", establishment: "Ate Rica's Bacsilog", profile: "Jane Smith" },
            { title: "Mongolian BBQ Heaven", body: "Mongolian Master serves amazing barbecue.", establishment: "Mongolian Master", profile: "Alex Johnson" },
            { title: "Cozy and Comfortable", body: "Prelude Cafe is a great place to relax.", establishment: "Prelude Cafe", profile: "Emily Davis" },
            { title: "Fresh and Delicious", body: "Subway's sandwiches are always fresh.", establishment: "Subway", profile: "Michael Brown" }
        ];
    
        // Script to extract search query from URL and display results
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const query = urlParams.get('query').toLowerCase();
            document.getElementById('search-query').innerText = query;
    
            const establishmentResultsContainer = document.querySelector('#establishment-results .grid');
            const reviewResultsContainer = document.querySelector('#review-results .grid');
            establishmentResultsContainer.innerHTML = '';
            reviewResultsContainer.innerHTML = '';
    
            const ratingFilter = document.getElementById('rating-filter');
            ratingFilter.addEventListener('change', () => filterResults(query));
    
            filterResults(query);
        }
    
        function filterResults(query) {
            const ratingFilterValue = parseFloat(document.getElementById('rating-filter').value) || 0;
    
            const filteredEstablishments = establishments.filter(establishment => {
                return (establishment.name.toLowerCase().includes(query) || establishment.description.toLowerCase().includes(query)) && establishment.rating >= ratingFilterValue;
            });
    
            const filteredReviews = reviews.filter(review => {
                return (review.title.toLowerCase().includes(query) || review.body.toLowerCase().includes(query));
            });
    
            const establishmentResultsContainer = document.querySelector('#establishment-results .grid');
            const reviewResultsContainer = document.querySelector('#review-results .grid');
    
            establishmentResultsContainer.innerHTML = '';
            reviewResultsContainer.innerHTML = '';
    
            filteredEstablishments.forEach(establishment => {
                const establishmentCard = document.createElement('div');
                establishmentCard.className = 'bg-white rounded-lg shadow-lg p-6 mb-4';
                establishmentCard.innerHTML = `
                    <a href="${establishment.link}">
                        <h1 class="text-2xl font-semibold mb-2">${establishment.name}</h1>
                    </a>
                    <div class="flex items-center mb-2">
                        <span class="text-yellow-500">&#9733;</span>
                        <span class="text-yellow-500">&#9733;</span>
                        <span class="text-yellow-500">&#9733;</span>
                        <span class="text-yellow-500">&#9733;</span>
                        <span class="text-gray-400">&#9733;</span>
                    </div>
                    <p class="text-gray-700">${establishment.description}</p>
                    <p class="text-gray-600 text-sm mt-2 mb-5">Rating: ${establishment.rating} (${establishment.reviews} reviews)</p>
                `;
                establishmentResultsContainer.appendChild(establishmentCard);
            });
    
            filteredReviews.forEach(review => {
                const reviewCard = document.createElement('div');
                reviewCard.className = 'bg-white rounded-lg shadow-lg p-6 mb-4';
                reviewCard.innerHTML = `
                    <h1 class="text-2xl font-semibold mb-2">${review.establishment}</h1>
                    <h3 class="text-base font-semibold mb-2">${review.title}</h3>
                    <div class="flex items-center mb-2">
                        <span class="text-yellow-500">&#9733;</span>
                        <span class="text-yellow-500">&#9733;</span>
                        <span class="text-yellow-500">&#9733;</span>
                        <span class="text-yellow-500">&#9733;</span>
                        <span class="text-gray-400">&#9733;</span>
                    </div>
                    <p class="text-gray-700">${review.body}</p>
                    <p class="text-gray-600 text-sm mt-2 mb-5">Profile: ${review.profile}</p>
                `;
                reviewResultsContainer.appendChild(reviewCard);
            });
        }
    </script>               
</body>
</html>